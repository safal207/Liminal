# WebSocket Tests Documentation

## üìã –û–±–∑–æ—Ä —Ç–µ—Å—Ç–æ–≤

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç comprehensive –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è WebSocket —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∏ –∑–∞—â–∏—Ç—ã –æ—Ç DoS –∞—Ç–∞–∫.

## üß™ –§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤

### 1. `test_websocket_python_client.py` ‚úÖ
**–û—Å–Ω–æ–≤–Ω—ã–µ WebSocket —Ç–µ—Å—Ç—ã**
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ WebSocket
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ JSON

**–ó–∞–ø—É—Å–∫:**
```bash
pytest tests/test_websocket_python_client.py -v -s
```

### 2. `test_websocket_limits_simple.py` ‚úÖ
**–¢–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã –æ—Ç DoS –∞—Ç–∞–∫**
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç)
- ‚úÖ –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç –ª–∏–º–∏—Ç–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (15 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π)
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –û–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ WebSocket

**–ó–∞–ø—É—Å–∫:**
```bash
pytest tests/test_websocket_limits_simple.py -v -s
```

### 3. `test_connection_limits.py` ‚ö†Ô∏è
**–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ª–∏–º–∏—Ç–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç HTTP API)**
- ‚ö†Ô∏è –õ–∏–º–∏—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ IP
- ‚ö†Ô∏è –≠–Ω–¥–ø–æ–∏–Ω—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- ‚ö†Ô∏è –û—á–∏—Å—Ç–∫–∞ —Å—á—ë—Ç—á–∏–∫–æ–≤ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
- ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è HTTP API —Ç–µ—Å—Ç–æ–≤.

### 4. `test_websocket_selenium.py` ‚ùå
**Selenium —Ç–µ—Å—Ç—ã (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç selenium (–ø—Ä–æ–±–ª–µ–º—ã —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π)
- ‚ùå –ó–∞–º–µ–Ω—ë–Ω –Ω–∞ Python WebSocket —Ç–µ—Å—Ç—ã

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã

### –í—Å–µ —Ä–∞–±–æ—á–∏–µ —Ç–µ—Å—Ç—ã:
```bash
pytest tests/test_websocket_python_client.py tests/test_websocket_limits_simple.py -v -s
```

### –û—Ç–¥–µ–ª—å–Ω—ã–µ –Ω–∞–±–æ—Ä—ã:
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ WebSocket —Ç–µ—Å—Ç—ã
pytest tests/test_websocket_python_client.py -v -s

# –¢–µ—Å—Ç—ã –∑–∞—â–∏—Ç—ã –æ—Ç DoS
pytest tests/test_websocket_limits_simple.py -v -s

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–Ω—É–∂–µ–Ω –∑–∞–ø—É—â–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
uvicorn main:app --reload --log-config logging.yaml
pytest tests/test_connection_limits.py -v -s
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã:
- **6/6** —Ç–µ—Å—Ç–æ–≤ –≤ `test_websocket_python_client.py`
- **4/4** —Ç–µ—Å—Ç–æ–≤ –≤ `test_websocket_limits_simple.py`
- **2/4** —Ç–µ—Å—Ç–æ–≤ –≤ `test_connection_limits.py` (WebSocket —á–∞—Å—Ç–∏)

### ‚ùå –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã:
- **2/4** —Ç–µ—Å—Ç–æ–≤ –≤ `test_connection_limits.py` (HTTP API —á–∞—Å—Ç–∏ - –Ω—É–∂–µ–Ω —Å–µ—Ä–≤–µ—Ä)
- **–í—Å–µ** —Ç–µ—Å—Ç—ã –≤ `test_websocket_selenium.py` (–ø—Ä–æ–±–ª–µ–º—ã —Å selenium)

## üõ°Ô∏è –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

### WebSocket –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –û—Ç–ø—Ä–∞–≤–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### DoS Protection:
- –õ–∏–º–∏—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (100 –æ–±—â–∏—Ö, 10 –Ω–∞ IP)
- –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø—Ä–µ–≤—ã—à–∞—é—â–∏—Ö –ª–∏–º–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤

–í `api.py`:
```python
connection_manager = ConnectionManager(
    max_connections=100,      # –û–±—â–∏–π –ª–∏–º–∏—Ç
    max_connections_per_ip=10 # –õ–∏–º–∏—Ç –Ω–∞ IP
)
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç unified logging system:
- –õ–æ–≥–∏ –≤ `test_websocket.log`
- SERVER DEBUG —Å–æ–æ–±—â–µ–Ω–∏—è
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

## üéØ –ò—Ç–æ–≥

**WebSocket backend –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!**

- ‚úÖ 10/10 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ DoS protection —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Unified logging —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Selenium —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
